# # Helicopter
#
#md # !!! note "Overview"
#md #     System type: linear continuous system\
#md #     State dimension: 28\
#md #     Application domain: 

# This is a 28-dimensional controlled helicopter model from [REF].

module helicopter #jl
using ReachabilityAnalysis, SparseArrays #jl

function helicopter_A()
    A = [[0, 0, 0, 0.998574, 0.0533843, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 1, -0.00318222, 0.0595247, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, -11.5705, -2.54464, -0.0636026, 0.106781, -0.0949187, 0.00710757, -5.20818, -23.1259, -4.24693, -0.710744, -1.4867, -0.0445482, 0.0343664, 0.0229902, 0.580153, 1.04755, 11.265, 2.62228, 0.382949, 0.453076, 0.0226519, 0.0125336, 0.108399, -0.160139, -6.11536, -0.0389724],
    [0, 0, 0.439357, -1.99818, 0, 0.0166519, 0.018462, -0.00118747, -10.7788, 0.343053, -0.0349493, -3.46674, 0.0134159, -0.00650175, -0.00724803, -0.00483591, -0.152495, 2.03915, -0.169614, -0.279125, -0.00367822, -0.00167971, 0.050812, 0.0432735, -0.0623053, 0.979163, 0.0404014, 0.010697],
    [0, 0, -2.0409, -0.458999, -0.735028, 0.0192558, -0.00459562, 0.00212036, -1.06433, -3.65916, -0.493547, -0.0595611, -1.95351, -0.0109391, -0.000271004, 0.0505639, 1.58834, 0.219924, 1.82192, 2.69319, 0.0686196, 0.08631, 0.00241543, 0.000727041, 0.640964, -0.0230167, -1.06985, -0.596675],
    [-32.1036, 0, -0.503355, 2.29786, 0, -0.0212158, -0.0211679, 0.0158116, 12.4592, -0.353637, 0.0641365, 4.03533, -0.272153, 0.00099959, 0.00252969, 0.111633, 2.73642, -2.35454, 0.175217, 0.863082, 0.00440128, 0.00437341, -0.059795, -0.0510055, 0.609532, -1.11578, -0.0263051, -0.0337389],
    [0.102161, 32.0578, -2.34722, -0.503612, 0.834948, 0.0212266, -0.0378797, 0.000354004, -0.76148, -5.12933, -1.13138, -0.148788, 1.38074, -0.012931, 0.00764572, 0.0737967, 1.36175, 0.150701, 2.45244, -1.44884, 0.0765163, 0.0871226, 0.00462319, 0.00263523, -0.0794019, -0.0310234, -1.22553, 0.657926],
    [-1.91097, 1.71383, -0.00400543, -0.0574112, 0, 0.0139896, -0.000906753, -0.290514, -2.06064, -0.774846, -0.471752, -1.21389, 5.03052, 0.126408, 0.113189, -2.07842, -50.1852, 0.340666, 0.375863, -10.6412, -0.00363415, -0.0479628, 0.0305097, 0.0275842, -10.5424, -0.126841, -0.391839, 0.420788],
    [0.126296, -0.00289825, -0.319316, 0.785202, 0.00177237, 5.84372e-06, 5.23381e-06, -9.78995e-05, -0.0726115, 0.00166629, 0.195701, 0.517339, 0.0523653, -3.35973e-06, -3.00908e-06, 5.62854e-05, -0, -0, -0, -0, -0, 0, -0, 0, 0, 0, 0, 0],
    [-0.0181141, 0.077615, 0.710897, 2.45428, -0.012793, 4.05106e-05, 3.62825e-05, -0.000678672, 0.0104143, -0.0446232, 0.564308, -1.50732, 0.0668797, -2.32908e-05, -2.08599e-05, 0.000390189, 0, 0, -0, -0, -0, 0, -0, 0, 0, 0, 0, 0],
    [-0.0199573, 0.00710897, 122.639, 1.7917, 0.13833, 7.26169e-07, 6.50379e-07, -1.21655e-05, -8.48115, -37.7139, -93.6582, -4.80197, -2.56739, 0.0341383, -0.0388801, 0.0446032, 0.946017, 1.70817, 18.3691, 4.27597, 0.62445, 0.738801, 0.0369369, 0.0204377, 0.17676, -0.261129, -9.9719, -0.0635496],
    [0.00785296, 0.00392575, 0.287856, 58.0535, 0.0306981, -6.8376e-06, -6.12396e-06, 0.00011455, -17.5807, 0.557136, 0.205947, -43.2308, 0.00422708, 0.00605385, 0.00664669, -0.00913893, -0.248663, 3.32511, -0.276579, -0.455151, -0.00599782, -0.00273899, 0.0828557, 0.0705632, -0.101597, 1.59665, 0.0658798, 0.0174429],
    [0.0114973, -0.012583, 13.8484, 22.2888, 0.0422873, 0.000197559, 0.00017694, -0.00330969, -1.74214, -5.95951, -11.333, -14.2165, -3.9448, 0.00130458, -0.00513926, 0.0864743, 2.59, 0.358615, 2.97089, 4.3916, 0.111893, 0.14074, 0.00393867, 0.00118554, 1.04518, -0.0375318, -1.74453, -0.972958],
    [-16.9391, 0.618054, 107.921, 204.524, 0.204408, 0.0047421, 0.00424717, -0.0794442, -2.04846, -0.93199, -66.5409, -116.47, -0.561301, -0.0223122, -0.0194847, 0.243519, 4.4621, -3.83939, 0.285714, 1.40737, 0.00717686, 0.00713142, -0.0975037, -0.0831712, 0.993922, -1.81943, -0.0428939, -0.0550157],
    [-0.54281, 7.08182, -135.012, 460.929, 0.0364986, 0.00693724, 0.0062132, -0.116219, -0.827455, 19.6222, 78.5537, -283.239, 3.06544, -0.00384762, -0.0289845, 0.187507, 2.22051, 0.245738, 3.99902, -2.36252, 0.12477, 0.142065, 0.00753873, 0.0042971, -0.129475, -0.0505877, -1.99839, 1.07284],
    [-1.28646, 0.142279, -1.26575, 65.7431, -1.3207, -0.061856, -0.0554001, 1.03627, -4.53149, 0.368539, 0.0024871, -42.3265, 8.96223, 0.255677, 0.215513, -4.27544, -81.8337, 0.5555, 0.612895, -17.3518, -0.00592597, -0.0782097, 0.0497501, 0.0449796, -17.1907, -0.206831, -0.638946, 0.686151],
    [0, 0, 0, 0, 0, -0.00970226, -0.00868964, 0.162541, 0, 0, 0, 0, 0, 0, 0, 0, -0.012, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [-8.15316, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.005, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, -3.26127, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.005, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0.174412, -3.26127, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.01, 0, 0, 0, 0, 0, 0, 0, 0],
    [-0, 0, -3.26127, -0, -0, -0, -0, 0, 0, -0, -0, 0, 0, 0, 0, -0, 0, 0, 0, -0, -8.5, -18, 0, 0, 0, 0, 0, 0],
    [0, 0, -0, -0, 0, -0, -0, 0, -0, 0, 0, 0, 0, 0, 0, -0, -0, -0, -0, -0, 1, 0, 0, 0, 0, 0, 0, 0],
    [-0, 0, 0, -8.15316, -0, -0, -0, 0, 0, 0, -0, 0, 0, 0, 0, -0, -0, 0, -0, 0, -0, 0, -8.5, -18, 0, 0, 0, 0],
    [0, 0, -0, -0, 0, -0, -0, 0, -0, 0, 0, 0, 0, 0, 0, -0, 0, -0, -0, -0, -0, 0, 1, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0.699961, 0.262038, 0.15959, 0.411552, -1.70162, -0.0427567, -0.0382852, 0.703046, 16.9757, -0.115788, -0.127109, 3.59954, 0.00122974, 0.0162237, -0.010334, -0.00934236, -6.43393, 0.0426396, 0.132541, -0.142338],
    [0, 0, 0, 0, 0, 0, 0, 0, -37.0015, 0.783589, -0.183855, -11.8696, -0.106084, -0.0263066, -0.0271181, 0.036745, 0.764602, 7.00237, -0.390319, -0.642631, -0.00570167, 0.00352225, 0.173868, 0.147911, 0.0560927, -6.64198, 0.0396022, 0.0261817],
    [0, 0, 0, 0, 0, 0, 0, 0, 1.9914, 13.76, 2.53042, 0.0825288, 0.728265, 0.0239028, -0.0228966, 0.0153276, 0.370477, -0.412566, -6.70095, -1.32704, -0.227019, -0.267482, -0.00865099, -0.00339436, 0.0987926, 0.197714, -6.3694, -0.0119768],
    [0, 0, 0, 0, 0, 0, 0, 0, 1.96586, -3.74313, -1.96265, 0.0189294, 11.145, -0.036002, -0.00122215, 0.602488, 11.6398, -0.407673, 1.50774, -12.8, 0.0053931, -0.0142088, -0.000915158, -0.000640326, -0.0365353, 0.012459, -0.083125, -5.47283]]

    return sparse(hcat(A...)')
end

function model(X0)
    # system matrix
    A = helicopter_A()

    # linear continuous system
    S = @system(x' = Ax)
    return IVP(S, X0)
end
end #jl


# [^REF]: XXX
